---
import "../../styles/global.css";
import { getCollection, type CollectionEntry, render } from "astro:content";

export async function getStaticPaths() {
  const collections = ["components", "blocks", "starters"] as const;
  const paths = [];

  for (const collectionName of collections) {
    const items = await getCollection(collectionName);
    paths.push(
      ...items.map((item) => ({
        params: {
          collection: collectionName,
          slug: item.slug,
        },
        props: {
          item,
          collectionName,
        },
      }))
    );
  }

  return paths;
}

type Props = {
  collectionName: "components" | "blocks" | "starters";
  item: CollectionEntry<"components" | "blocks" | "starters">;
};

const { item, collectionName } = Astro.props as Props;
const { Content } = await render(item);
---

<html>
  <head>
    <title>{item.data.title || `${collectionName} - ${item.slug}`}</title>
    <meta name="description" content={item.data.description} />
  </head>
  <body>
    <article>
      <header>
        <h1>{item.data.title || item.slug}</h1>
        {item.data.description && <p>{item.data.description}</p>}
        <div>
          <span>Collection: {collectionName}</span>
          {item.data.status && <span>Status: {item.data.status}</span>}
        </div>
      </header>
      <Content />
    </article>
  </body>
</html>
